import React, { useEffect, useState } from 'react';
import { Flex, Image, Text } from '@chakra-ui/react';
import { useRouter } from 'next/router';
import logoApp from './Ecoexya.png';

interface Page {
  name: string;
  url: string;
  path: string;
}

const Pages: Page[] = [
  {
    name: 'Defis',
    url: '/challenges',
    path: 'M18.788 8.87286L18.6229 8.58474L14.8195 1.94739C14.8195 1.94735 14.8195 1.94732 14.8195 1.94729C14.7344 1.79888 14.6134 1.67726 14.4697 1.59334C14.3261 1.50946 14.1644 1.46582 14.0005 1.46582C13.8366 1.46582 13.6749 1.50946 13.5313 1.59334C13.3877 1.67726 13.2667 1.79888 13.1816 1.94729C13.1815 1.94732 13.1815 1.94735 13.1815 1.94739L9.37808 8.58474L9.21297 8.87286L8.88866 8.94429L1.50216 10.5711C1.34157 10.6065 1.19162 10.6844 1.06771 10.7983C0.943705 10.9122 0.850086 11.0585 0.797557 11.223C0.74501 11.3876 0.735785 11.5637 0.770994 11.7333C0.806196 11.9029 0.884309 12.0589 0.996243 12.1861L0.996443 12.1863L6.03146 17.9135L6.24685 18.1585L6.21449 18.4831L5.45243 26.1263L5.45242 26.1264C5.43517 26.2992 5.46286 26.4731 5.53219 26.6306C5.60148 26.7881 5.70952 26.9228 5.8442 27.0223C5.97878 27.1217 6.13554 27.1827 6.29868 27.2004C6.4618 27.2181 6.62697 27.1921 6.77802 27.1244L6.77816 27.1244L13.6938 24.0256L14.0005 23.8882L14.3072 24.0256L21.2229 27.1244L21.223 27.1244C21.374 27.1921 21.5392 27.2181 21.7023 27.2004C21.8655 27.1827 22.0222 27.1217 22.1568 27.0223C22.2915 26.9228 22.3995 26.7881 22.4688 26.6306C22.5382 26.4731 22.5659 26.2992 22.5486 26.1264L22.5486 26.1263L21.7865 18.4831L21.7542 18.1586L21.9695 17.9136L27.0043 12.1852C27.0044 12.1852 27.0045 12.1851 27.0045 12.185C27.1162 12.0578 27.194 11.902 27.2291 11.7326C27.2642 11.563 27.2549 11.3871 27.2024 11.2226L27.9168 10.9944L27.2024 11.2226C27.1499 11.0582 27.0563 10.9121 26.9325 10.7982C26.8088 10.6844 26.6591 10.6066 26.4989 10.5711L18.788 8.87286ZM18.788 8.87286L19.1124 8.94429L26.4984 10.571L18.788 8.87286Z',
  },
  {
    name: 'Catégories',
    url: '/categories',
    path: 'M7 3.38391e-09C7.2198 -1.80724e-05 7.43348 0.0723807 7.608 0.206L7.708 0.293L10.414 3H17C17.7652 2.99996 18.5015 3.29233 19.0583 3.81728C19.615 4.34224 19.9501 5.06011 19.995 5.824L20 6V14C20 14.7652 19.7077 15.5015 19.1827 16.0583C18.6578 16.615 17.9399 16.9501 17.176 16.995L17 17H3C2.23479 17 1.49849 16.7077 0.941739 16.1827C0.384993 15.6578 0.0498925 14.9399 0.00500012 14.176L4.66045e-09 14V3C-4.26217e-05 2.23479 0.292325 1.49849 0.817284 0.941739C1.34224 0.384993 2.06011 0.0498925 2.824 0.00500012L3 3.38391e-09H7Z',
  },
  {
    name: 'Utilisateurs',
    url: '/users',
    path: 'M3.444 16.8802H3.44091C3.09127 16.8788 2.74425 16.9484 2.41956 17.0857C2.09481 17.223 1.79811 17.4256 1.54707 17.683C1.29598 17.9405 1.09556 18.2476 0.95837 18.5874C0.821206 18.9272 0.750222 19.2922 0.75 19.6613L3.444 16.8802ZM3.444 16.8802H20.5714C21.2746 16.8802 21.9536 17.1677 22.4577 17.6869C22.9626 18.2069 23.25 18.9167 23.25 19.6613C23.25 22.3684 21.9701 24.3977 19.9284 25.7382C17.8908 27.0755 15.0867 27.7391 12 27.7391C8.91321 27.7391 6.10914 27.0755 4.07153 25.7382M3.444 16.8802L4.07153 25.7382M4.07153 25.7382C2.0295 24.3957 0.750113 22.3699 0.75 19.6617L4.07153 25.7382ZM7.68935 2.83117C8.83648 1.64973 10.3875 0.990234 12 0.990234C13.6125 0.990234 15.1635 1.64973 16.3106 2.83117C17.4585 4.01336 18.1071 5.62134 18.1071 7.30246C18.1071 8.98358 17.4585 10.5916 16.3106 11.7737C15.1635 12.9552 13.6125 13.6147 12 13.6147C10.3875 13.6147 8.83648 12.9552 7.68935 11.7737C6.54149 10.5916 5.89286 8.98358 5.89286 7.30246C5.89286 5.62134 6.54149 4.01336 7.68935 2.83117Z',
  },
  {
    name: 'Équipes',
    url: '/teams',
    path: 'M 7 0 C 6.73762 -3.90978e-9 6.47781 0.0516797 6.2354 0.152089 C 5.99299 0.252498 5.77273 0.399669 5.5872 0.585201 C 5.40167 0.770732 5.2545 0.99099 5.15409 1.2334 C 5.05368 1.47581 5.002 1.73562 5.002 1.998 C 5.002 2.26038 5.05368 2.52019 5.15409 2.7626 C 5.2545 3.00501 5.40167 3.22527 5.5872 3.4108 C 5.77273 3.59633 5.99299 3.7435 6.2354 3.84391 C 6.47781 3.94432 6.73762 3.996 7 3.996 C 7.5299 3.996 8.0381 3.7855 8.4128 3.4108 C 8.7875 3.0361 8.998 2.5279 8.998 1.998 C 8.998 1.4681 8.7875 0.959898 8.4128 0.585201 C 8.0381 0.210503 7.5299 0 7 0 Z M 11.5 0.998 C 11.1022 0.998 10.7206 1.15604 10.4393 1.43734 C 10.158 1.71864 10 2.10018 10 2.498 C 10 2.89582 10.158 3.27736 10.4393 3.55866 C 10.7206 3.83996 11.1022 3.998 11.5 3.998 C 11.8978 3.998 12.2794 3.83996 12.5607 3.55866 C 12.842 3.27736 13 2.89582 13 2.498 C 13 2.10018 12.842 1.71864 12.5607 1.43734 C 12.2794 1.15604 11.8978 0.998 11.5 0.998 Z M 2.5 0.998 C 2.10218 0.998 1.72064 1.15604 1.43934 1.43734 C 1.15804 1.71864 1 2.10018 1 2.498 C 1 2.89582 1.15804 3.27736 1.43934 3.55866 C 1.72064 3.83996 2.10218 3.998 2.5 3.998 C 2.89782 3.998 3.27936 3.83996 3.56066 3.55866 C 3.84197 3.27736 4 2.89582 4 2.498 C 4 2.10018 3.84197 1.71864 3.56066 1.43734 C 3.27936 1.15604 2.89782 0.998 2.5 0.998 Z M 4 5.991 C 4.00185 5.727 4.10802 5.47444 4.29536 5.28841 C 4.48269 5.10239 4.73599 4.99799 5 4.998 H 9 C 9.26522 4.998 9.51957 5.10336 9.70711 5.29089 C 9.89464 5.47843 10 5.73278 10 5.998 V 8.998 C 9.99993 9.31272 9.95067 9.6255 9.854 9.925 C 9.63257 10.6037 9.17644 11.1812 8.56751 11.5539 C 7.95859 11.9266 7.23675 12.0699 6.53163 11.9583 C 5.8265 11.8466 5.18428 11.4872 4.72028 10.9447 C 4.25628 10.4021 4.0009 9.71191 4 8.998 V 5.998 V 5.991 Z M 3 5.998 C 3 5.633 3.097 5.292 3.268 4.998 H 1 C 0.734784 4.998 0.48043 5.10336 0.292893 5.29089 C 0.105357 5.47843 1.38413e-7 5.73278 1.38413e-7 5.998 V 8.498 C -0.000136048 8.90731 0.100226 9.31038 0.292273 9.67184 C 0.48432 10.0333 0.762176 10.3421 1.10144 10.571 C 1.44071 10.8 1.831 10.9422 2.23806 10.9851 C 2.64511 11.028 3.05646 10.9702 3.436 10.817 C 3.14818 10.2536 2.99872 9.62968 3 8.997 V 5.998 Z M 11 5.998 V 8.998 C 11 9.653 10.843 10.271 10.564 10.817 C 10.9435 10.9702 11.3549 11.028 11.7619 10.9851 C 12.169 10.9422 12.5593 10.8 12.8986 10.571 C 13.2378 10.3421 13.5157 10.0333 13.7077 9.67184 C 13.8998 9.31038 14.0001 8.90731 14 8.498 V 5.998 C 14 5.73278 13.8946 5.47843 13.7071 5.29089 C 13.5196 5.10336 13.2652 4.998 13 4.998 H 10.732 C 10.902 5.292 11 5.633 11 5.998 Z',
  },
];

interface IconNavbarProps {
  d: string | undefined;
  fill: string;
}

function IconNavbar({ d, fill }: IconNavbarProps) {
  return (
    <svg
      width="26"
      height="26"
      viewBox="0 0 28 28"
      stroke="#166879"
      strokeWidth="1.5"
    >
      <path d={d} fill={fill} />
    </svg>
  );
}

interface FindPageByNameProps {
  pageName: string;
}

const findPageByName = ({
  pageName,
}: FindPageByNameProps): Page | undefined => {
  return Pages.find((page: Page) => page.name === pageName);
};

function Sidebar() {
  const [windowWidth, setWindowWidth] = useState(0);

  useEffect(() => {
    const handleResize = () => {
      setWindowWidth(window.innerWidth);
    };

    handleResize(); // Appel initial pour définir la largeur de la fenêtre
    window.addEventListener('resize', handleResize);

    return () => {
      window.removeEventListener('resize', handleResize);
    };
  }, []);

  const router = useRouter();

  return (
    <Flex
      zIndex={10}
      bg="white"
      color="grey.800"
      p={4}
      gap={4}
      flexDirection={windowWidth < 500 ? 'row' : 'column'}
      w={windowWidth < 500 ? '100%' : '250px'}
      h={windowWidth < 500 ? '120px' : '100vh'}
      position="fixed"
      left="0"
      top={windowWidth < 500 ? 'auto' : '0'}
      boxShadow="xl"
      bottom={windowWidth < 500 ? '0' : 'auto'}
    >
      {windowWidth > 500 && (
        <Image src={logoApp.src} w="160px" alt="logo" m={4} />
      )}
      {Pages.map((page) => (
        <Flex
          flex={windowWidth < 500 ? 1 : 0}
          flexDirection={windowWidth < 500 ? 'column' : 'row'}
          key={page.name}
          py="4"
          px="6"
          gap="16px"
          borderRadius="md"
          alignItems="center"
          fontSize={windowWidth < 500 ? '12px' : 'auto'}
          color={router.pathname.includes(page.url) ? 'white' : 'grey.800'}
          fontWeight={router.pathname.includes(page.url) ? 'bold' : 'light'}
          _hover={{
            bg: router.pathname.includes(page.url) ? 'primary.100' : '#F1F1F1',
            cursor: 'pointer',
          }}
          bg={router.pathname.includes(page.url) ? 'primary.100' : 'auto'}
          onClick={() => router.push(`/admin${page.url}`)}
          transition="background 0.3s ease, fontWeight 0.8s ease"
        >
          <IconNavbar
            d={findPageByName({ pageName: page.name })?.path}
            fill={
              router.pathname.includes(page.url) ? '#166879' : 'transparent'
            }
          />
          <Text
            color="primary.300"
            fontWeight={router.pathname.includes(page.url) ? 'bold' : 'light'}
            lineHeight={1}
            fontSize={windowWidth < 500 ? '12px' : '16px'}
          >
            {page.name}
          </Text>
        </Flex>
      ))}
    </Flex>
  );
}

export default Sidebar;
